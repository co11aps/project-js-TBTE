{"version":3,"file":"commonHelpers.js","sources":["../src/auth.ts"],"sourcesContent":["import { initializeApp } from 'firebase/app';\nimport {\n  connectAuthEmulator,\n  createUserWithEmailAndPassword,\n  getAuth,\n  onAuthStateChanged,\n  sendEmailVerification,\n  sendPasswordResetEmail,\n  signInWithEmailAndPassword,\n  signOut,\n  updateProfile,\n} from 'firebase/auth';\nimport { firebaseConfig } from './js/config';\n\ninitializeApp(firebaseConfig);\n\nconst auth = getAuth();\n\nif (window.location.hostname === 'localhost') {\n  connectAuthEmulator(auth, 'http://127.0.0.1:9099');\n}\n\nconst emailInput = document.getElementById('email')! as HTMLInputElement;\nconst passwordInput = document.getElementById('password')! as HTMLInputElement;\nconst userNameInput = document.getElementById('user-name')! as HTMLInputElement;\nconst signInButton = document.getElementById(\n  'quickstart-sign-in'\n)! as HTMLButtonElement;\nconst signUpButton = document.getElementById(\n  'quickstart-sign-up'\n)! as HTMLButtonElement;\nconst passwordResetButton = document.getElementById(\n  'quickstart-password-reset'\n)! as HTMLButtonElement;\nconst verifyEmailButton = document.getElementById(\n  'quickstart-verify-email'\n)! as HTMLButtonElement;\nconst signInStatus = document.getElementById(\n  'quickstart-sign-in-status'\n)! as HTMLSpanElement;\nconst accountDetails = document.getElementById(\n  'quickstart-account-details'\n)! as HTMLDivElement;\n\n/**\n * Handles the sign in button press.\n */\nfunction toggleSignIn() {\n  if (auth.currentUser) {\n    signOut(auth);\n  } else {\n    const email = emailInput.value;\n    const password = passwordInput.value;\n\n    if (email.length < 4) {\n      alert('Please enter an email address.');\n      return;\n    }\n    if (password.length < 4) {\n      alert('Please enter a password.');\n      return;\n    }\n    // Sign in with email and pass.\n    signInWithEmailAndPassword(auth, email, password).catch(function (error) {\n      // Handle Errors here.\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      if (errorCode === 'auth/wrong-password') {\n        alert('Wrong password.');\n      } else {\n        alert(errorMessage);\n      }\n      console.log(error);\n      signInButton.disabled = false;\n    });\n  }\n  signInButton.disabled = true;\n}\n\n/**\n * Handles the sign up button press.\n */\nfunction handleSignUp() {\n  const email = emailInput.value;\n  const password = passwordInput.value;\n  const userName = userNameInput.value;\n  if (email.length < 4) {\n    alert('Please enter an email address.');\n    return;\n  }\n  if (password.length < 4) {\n    alert('Please enter a password.');\n    return;\n  }\n  // Create user with email and pass.\n  createUserWithEmailAndPassword(auth, email, password)\n    .then(userCredential =>\n      updateProfile(userCredential.user, {\n        displayName: 'Jane Q. User',\n        photoURL: 'https://example.com/jane-q-user/profile.jpg',\n      })\n    )\n    .catch(function (error) {\n      // Handle Errors here.\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      if (errorCode == 'auth/weak-password') {\n        alert('The password is too weak.');\n      } else {\n        alert(errorMessage);\n      }\n      console.log(error);\n    });\n}\n\n/**\n * Sends an email verification to the user.\n */\nfunction sendVerificationEmailToUser() {\n  sendEmailVerification(auth.currentUser!).then(function () {\n    // Email Verification sent!\n    alert('Email Verification Sent!');\n  });\n}\n\nfunction sendPasswordReset() {\n  const email = emailInput.value;\n  sendPasswordResetEmail(auth, email)\n    .then(function () {\n      // Password Reset Email Sent!\n      alert('Password Reset Email Sent!');\n    })\n    .catch(function (error) {\n      // Handle Errors here.\n      const errorCode = error.code;\n      const errorMessage = error.message;\n      if (errorCode == 'auth/invalid-email') {\n        alert(errorMessage);\n      } else if (errorCode == 'auth/user-not-found') {\n        alert(errorMessage);\n      }\n      console.log(error);\n    });\n}\n\n// Listening for auth state changes.\nonAuthStateChanged(auth, function (user) {\n  verifyEmailButton.disabled = true;\n  if (user) {\n    // User is signed in.\n    const displayName = user.displayName;\n    const email = user.email;\n    const emailVerified = user.emailVerified;\n    const photoURL = user.photoURL;\n    const isAnonymous = user.isAnonymous;\n    const uid = user.uid;\n    const providerData = user.providerData;\n    signInStatus.textContent = 'Signed in';\n    signInButton.textContent = 'Sign out';\n    accountDetails.textContent = JSON.stringify(user, null, '  ');\n    if (!emailVerified) {\n      verifyEmailButton.disabled = false;\n    }\n  } else {\n    // User is signed out.\n    signInStatus.textContent = 'Signed out';\n    signInButton.textContent = 'Sign in';\n    accountDetails.textContent = 'null';\n  }\n  signInButton.disabled = false;\n});\n\nsignInButton.addEventListener('click', toggleSignIn, false);\nsignUpButton.addEventListener('click', handleSignUp, false);\nverifyEmailButton.addEventListener('click', sendVerificationEmailToUser, false);\npasswordResetButton.addEventListener('click', sendPasswordReset, false);\n"],"names":["initializeApp","firebaseConfig","auth","getAuth","connectAuthEmulator","emailInput","passwordInput","userNameInput","signInButton","signUpButton","passwordResetButton","verifyEmailButton","signInStatus","accountDetails","toggleSignIn","signOut","email","password","signInWithEmailAndPassword","error","errorCode","errorMessage","handleSignUp","createUserWithEmailAndPassword","userCredential","updateProfile","sendVerificationEmailToUser","sendEmailVerification","sendPasswordReset","sendPasswordResetEmail","onAuthStateChanged","user","emailVerified"],"mappings":"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"}