{"version":3,"file":"commonHelpers2.js","sources":["../src/images/books-stack-mobile.png","../src/images/books-stack.png","../src/shopping-list.js"],"sourcesContent":["export default \"__VITE_ASSET__610a8eb0__\"","export default \"__VITE_ASSET__97dc1e92__\"","import './js/active-page-link.js';\nimport './js/active-page-menu.js';\nimport './js/mobile-menu.js';\nimport './js/active-page-link.js';\nimport './js/active-page-menu.js';\nimport './js/mobile-menu.js';\nimport './js/storage.js';\nimport './js/dark-theme.js';\nimport './js/supporters.js';\nimport bookStackImageMobile from './images/books-stack-mobile.png';\nimport bookStackImage from './images/books-stack.png';\nimport amazonLogo from './images/amazon-logo.png';\nimport appleBooksLogo from './images/apple-books-logo.png';\nimport iconsDelete from './images/icons.svg';\n\nimport Pagination from 'tui-pagination';\nimport refs from './js/refs.js';\nconst boxPagination = document.querySelector('#pagination');\n\nconst STORAGE_KEY = 'storage-of-books';\nconst shoppingListUl = document.querySelector('.shopping-list');\n\n//повідомлення про відсутність книг\nconst emptyMessageContainer = document.createElement('li');\nemptyMessageContainer.classList.add('empty-message');\nemptyMessageContainer.innerHTML = `\n  <p>This page is empty, add some books and proceed to order.</p>\n  <img \n    class=\"book-stack-image\"\n    srcset=\"${bookStackImageMobile} 767w, \n            ${bookStackImage} 768w\" \n    sizes=\"(max-width: 767px) 265px, 100vw\" \n    src=\"${bookStackImage}\" \n    alt=\"Empty Book Stack\"  \n  />\n`;\n// let storedBooks = [];\n// отримання збережених книг з localStorage\nasync function getStoredBooks() {\n  try {\n    const storedBooks = await new Promise((resolve, reject) => {\n      const data = localStorage.getItem(STORAGE_KEY);\n      if (data) {\n        resolve(JSON.parse(data));\n      } else {\n        resolve([]);\n      }\n    });\n    return storedBooks;\n  } catch (error) {\n    console.error('Error getting stored books:', error);\n    throw error;\n  }\n}\n// Функція для створення карти книги\nfunction createBookCard(book) {\n  const { title, category, list_name, author, _id, buy_links, book_image } =\n    book;\n  const card = document.createElement('div');\n  card.classList.add('book-card');\n\n  card.innerHTML = `\n    <div class=\"card-book\">\n  <img class=\"book-cover\" src=\"${book_image}\" alt=\"${title}\" id=\"${_id}\" />\n  <div class=\"shopping-list-img-description\">\n    <h2 class=\"book-title\">${title}</h2>\n    <h3 class=\"book-category\">${category}</h3>\n    <p class=\"book-description\">${list_name}</p>\n    <p class=\"book-author\">${author}</p>\n    <ul class=\"storage-shops\">\n      <li class=\"list-shop\">\n        <a href=\"${buy_links[0].url}\" target=\"_blank\" class=\"storage-shop-link\">\n          <img class=\"amazon\" width=\"32\" height=\"11\"  src=\"${amazonLogo}\" alt=\"Shop Logo\" />\n        </a>\n      </li>\n      <li class=\"list-shop\">\n        <a href=\"${buy_links[1].url}\" target=\"_blank\" class=\"storage-shop-link\">\n          <img class=\"book-shop\" width=\"16\" height=\"16\" src=\"${appleBooksLogo}\" alt=\"Shop Logo\" />\n        </a>\n      </li>\n    </ul>\n    <button class=\"remove-book-btn\" data-book-id=\"${_id}\">\n      <svg width=\"38\" height=\"38\" class=\"remove-icon\">\n        <use href=\"./images/icons.svg#icon-dump\"></use>\n      </svg>\n    </button>\n  </div>\n</div>\n  `;\n\n  return card;\n}\n\n\n// ========= PAGINATION ===============\n\n\n// Функція отримання кількості книжок у Shopping List\nfunction shoppingListCalc() {\n  const storedBooksString = localStorage.getItem(STORAGE_KEY);\n\n  if (storedBooksString) {\n    const arrayLength = JSON.parse(storedBooksString).length;\n    return Number(arrayLength);\n  } else {\n    console.log(\"Значення відсутнє у локальному сховищі.\");\n    return 0;\n  }\n}\n\n\nlet totalResults = shoppingListCalc();\n  console.log('Stored books length:', totalResults);\n\n// Створення екземпляру пагінації\nconst pagination = new Pagination(boxPagination, {\n  totalItems: totalResults,\n  itemsPerPage: 3,\n  visiblePages: 3,\n  page: 1,\n});\nconsole.log(pagination);\n \n\ndocument.querySelector('.container-pagination').classList.add('is-hidden');\n// Функція для відображення списку книг\nasync function renderBooks(totalResults, page) {\n  try {\n    const storedBooks = await getStoredBooks();\n    shoppingListUl.innerHTML = '';\n\n    if (Array.isArray(storedBooks) && storedBooks.length > 0) {\n      console.log(storedBooks);\n\n      const startIndex = (page - 1) * 3;\n      const endIndex = startIndex + 3;\n  \n      const firstThreeBooks = storedBooks.slice(startIndex, endIndex);\n\n      firstThreeBooks.forEach(book => {\n        const li = document.createElement('li');\n        li.appendChild(createBookCard(book));\n        shoppingListUl.appendChild(li);\n      });\n\n      // Показати пагінацію, якщо кількість книг >= 4\n      if (storedBooks.length >= 4) {\n        document.querySelector('.container-pagination').classList.remove('is-hidden');\n      } else {\n        // Приховати пагінацію, якщо кількість книг < 4\n        document.querySelector('.container-pagination').classList.add('is-hidden');\n      }\n    } else {\n      // Якщо немає збережених книг, вивести повідомлення про відсутність\n      shoppingListUl.appendChild(emptyMessageContainer);\n      \n      // Приховати пагінацію, якщо кількість книг < 4\n      document.querySelector('.container-pagination').classList.add('is-hidden');\n    }\n  } catch (error) {\n    console.error('Error rendering books:', error);\n  }\n}\n\n// Функція для оновлення totalItems та оновлення пагінації\nfunction updatePaginationTotalItems() {\n  // pagination.movePageTo(1)\n  pagination.reset();\n\n  totalResults = shoppingListCalc();\n  pagination.setTotalItems(totalResults);\n  \n}\n\npagination.on('beforeMove', (event) => {\n  \n  const currentPage = event.page;\n  renderBooks(totalResults, currentPage);\n  console.log(currentPage);\n});\n\n\nrenderBooks(totalResults, 1);\n\n\n\nlet updatedBooks;\n\n// Функція для видалення книг з LS\nasync function removeBookFromLocalStorage(bookId) {\n  try {\n    const storedBooks = await getStoredBooks();\n    updatedBooks = storedBooks.filter(book => book._id !== bookId);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedBooks));\n    \n    updatePaginationTotalItems()\n\n    renderBooks(totalResults, 1);\n  } catch (error) {\n    console.error('Error removing book from localStorage:', error);\n  }\n}\n\n\n\nconst container = document.querySelector('.shopping-list');\ncontainer.addEventListener('click', async event => {\n  const removeButton = event.target.closest('.remove-book-btn');\n  if (removeButton) {\n    const bookId = removeButton.getAttribute('data-book-id');\n    console.log('Remove button clicked for book ID:', bookId);\n    await removeBookFromLocalStorage(bookId);\n    // Оновлення конфігурації пагінації\n    pagination.reset();\n    //  updatePaginationTotalItems()\n\n  }\n});\n\n"],"names":["bookStackImageMobile","bookStackImage","boxPagination","STORAGE_KEY","shoppingListUl","emptyMessageContainer","getStoredBooks","resolve","reject","data","error","createBookCard","book","title","category","list_name","author","_id","buy_links","book_image","card","amazonLogo","appleBooksLogo","shoppingListCalc","storedBooksString","arrayLength","totalResults","pagination","Pagination","renderBooks","page","storedBooks","startIndex","endIndex","li","updatePaginationTotalItems","event","currentPage","updatedBooks","removeBookFromLocalStorage","bookId","container","removeButton"],"mappings":"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"}